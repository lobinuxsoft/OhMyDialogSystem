<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dialogue Nodes - OhMyDialogSystem Wiki</title>
  <link rel="stylesheet" href="../styles.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>
    /* ============================================
       Dialogue Node Visual System
       ============================================ */

    /* Node color palette */
    :root {
      --node-start: #10b981;
      --node-end: #ef4444;
      --node-ai: #3b82f6;
      --node-static: #6b7280;
      --node-choice: #eab308;
      --node-condition: #f97316;
      --node-event: #a855f7;
      --node-variable: #06b6d4;
      --node-jump: #22c55e;
      --node-free: #0ea5e9;
      --node-return: #34d399;
    }

    /* Node catalog grid */
    .node-catalog {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1.5rem;
      margin: 2rem 0;
    }

    /* Individual node card */
    .node-card {
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      overflow: hidden;
      transition: all 0.3s ease;
    }

    .node-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
    }

    .node-card.new-concept {
      border: 2px solid var(--ai-cyan);
      position: relative;
    }

    .node-card.new-concept::before {
      content: 'NUEVO';
      position: absolute;
      top: 0;
      right: 0;
      background: linear-gradient(90deg, var(--ai-cyan), var(--ai-purple));
      color: var(--bg-primary);
      font-size: 0.6rem;
      font-weight: bold;
      padding: 0.3rem 0.8rem;
      border-radius: 0 10px 0 8px;
      letter-spacing: 1px;
      z-index: 10;
    }

    /* Node header with color stripe */
    .node-header {
      padding: 1rem 1.25rem;
      display: flex;
      align-items: center;
      gap: 0.75rem;
      border-bottom: 1px solid var(--border-color);
      position: relative;
    }

    .node-header::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 4px;
    }

    .node-header.start::before { background: var(--node-start); }
    .node-header.end::before { background: var(--node-end); }
    .node-header.ai::before { background: var(--node-ai); }
    .node-header.static::before { background: var(--node-static); }
    .node-header.choice::before { background: var(--node-choice); }
    .node-header.condition::before { background: var(--node-condition); }
    .node-header.event::before { background: var(--node-event); }
    .node-header.variable::before { background: var(--node-variable); }
    .node-header.jump::before { background: var(--node-jump); }
    .node-header.free::before { background: var(--node-free); }
    .node-header.return::before { background: var(--node-return); }

    .node-icon {
      width: 40px;
      height: 40px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.25rem;
      flex-shrink: 0;
    }

    .node-icon.start { background: rgba(16, 185, 129, 0.15); color: var(--node-start); }
    .node-icon.end { background: rgba(239, 68, 68, 0.15); color: var(--node-end); }
    .node-icon.ai { background: rgba(59, 130, 246, 0.15); color: var(--node-ai); box-shadow: 0 0 15px rgba(59, 130, 246, 0.3); }
    .node-icon.static { background: rgba(107, 114, 128, 0.15); color: var(--node-static); }
    .node-icon.choice { background: rgba(234, 179, 8, 0.15); color: var(--node-choice); }
    .node-icon.condition { background: rgba(249, 115, 22, 0.15); color: var(--node-condition); }
    .node-icon.event { background: rgba(168, 85, 247, 0.15); color: var(--node-event); }
    .node-icon.variable { background: rgba(6, 182, 212, 0.15); color: var(--node-variable); }
    .node-icon.jump { background: rgba(34, 197, 94, 0.15); color: var(--node-jump); }
    .node-icon.free { background: linear-gradient(135deg, rgba(14, 165, 233, 0.2), rgba(168, 85, 247, 0.2)); color: var(--node-free); }
    .node-icon.return { background: linear-gradient(135deg, rgba(52, 211, 153, 0.2), rgba(34, 197, 94, 0.2)); color: var(--node-return); }

    .node-title {
      font-family: var(--font-mono);
      font-size: 0.9rem;
      font-weight: 600;
      color: var(--text-primary);
    }

    .node-subtitle {
      font-size: 0.75rem;
      color: var(--text-muted);
      margin-top: 0.15rem;
    }

    /* Node body */
    .node-body {
      padding: 1.25rem;
    }

    .node-description {
      font-size: 0.9rem;
      color: var(--text-secondary);
      margin-bottom: 1rem;
      line-height: 1.5;
    }

    /* Node slots visualization */
    .node-slots {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.75rem;
      background: var(--bg-tertiary);
      border-radius: 6px;
      margin-bottom: 1rem;
    }

    .slot {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.75rem;
      font-family: var(--font-mono);
      color: var(--text-muted);
    }

    .slot-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      border: 2px solid;
    }

    .slot-dot.input { border-color: var(--ai-green); background: rgba(16, 185, 129, 0.3); }
    .slot-dot.output { border-color: var(--ai-cyan); background: rgba(0, 212, 255, 0.3); }
    .slot-dot.output-multi { border-color: var(--node-choice); background: rgba(234, 179, 8, 0.3); }
    .slot-dot.special { border-color: var(--ai-purple); background: rgba(168, 85, 247, 0.3); }

    /* Node properties */
    .node-props {
      font-size: 0.8rem;
    }

    .node-props dt {
      font-family: var(--font-mono);
      color: var(--ai-purple);
      margin-bottom: 0.25rem;
    }

    .node-props dd {
      color: var(--text-secondary);
      margin-bottom: 0.75rem;
      margin-left: 0;
      padding-left: 1rem;
      border-left: 2px solid var(--border-color);
    }

    /* Flow diagram */
    .flow-diagram {
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      padding: 2rem;
      margin: 2rem 0;
      overflow-x: auto;
    }

    .flow-title {
      text-align: center;
      margin-bottom: 1.5rem;
    }

    .flow-title h3 {
      margin: 0;
      color: var(--ai-cyan);
    }

    .flow-title p {
      font-size: 0.85rem;
      color: var(--text-muted);
      margin: 0.5rem 0 0 0;
    }

    /* Flow nodes */
    .flow-container {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      min-width: 800px;
    }

    .flow-row {
      display: flex;
      align-items: center;
      gap: 1rem;
      justify-content: flex-start;
    }

    .flow-row.centered {
      justify-content: center;
    }

    .flow-row.indented {
      margin-left: 3rem;
    }

    .flow-row.indented-2 {
      margin-left: 6rem;
    }

    .flow-node {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.6rem 1rem;
      border-radius: 8px;
      font-size: 0.8rem;
      font-family: var(--font-mono);
      white-space: nowrap;
      border: 1px solid;
      position: relative;
    }

    .flow-node.start { background: rgba(16, 185, 129, 0.1); border-color: var(--node-start); color: var(--node-start); }
    .flow-node.end { background: rgba(239, 68, 68, 0.1); border-color: var(--node-end); color: var(--node-end); }
    .flow-node.ai { background: rgba(59, 130, 246, 0.1); border-color: var(--node-ai); color: var(--node-ai); }
    .flow-node.static { background: rgba(107, 114, 128, 0.1); border-color: var(--node-static); color: var(--node-static); }
    .flow-node.choice { background: rgba(234, 179, 8, 0.1); border-color: var(--node-choice); color: var(--node-choice); }
    .flow-node.condition { background: rgba(249, 115, 22, 0.1); border-color: var(--node-condition); color: var(--node-condition); }
    .flow-node.event { background: rgba(168, 85, 247, 0.1); border-color: var(--node-event); color: var(--node-event); }
    .flow-node.variable { background: rgba(6, 182, 212, 0.1); border-color: var(--node-variable); color: var(--node-variable); }
    .flow-node.jump { background: rgba(34, 197, 94, 0.1); border-color: var(--node-jump); color: var(--node-jump); }
    .flow-node.free {
      background: linear-gradient(135deg, rgba(14, 165, 233, 0.15), rgba(168, 85, 247, 0.15));
      border-color: var(--node-free);
      color: var(--node-free);
      box-shadow: 0 0 15px rgba(14, 165, 233, 0.2);
    }
    .flow-node.return {
      background: linear-gradient(135deg, rgba(52, 211, 153, 0.15), rgba(34, 197, 94, 0.15));
      border-color: var(--node-return);
      color: var(--node-return);
    }

    .flow-arrow {
      color: var(--text-muted);
      font-size: 1.2rem;
    }

    .flow-branch {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      padding: 1rem;
      background: rgba(234, 179, 8, 0.05);
      border: 1px dashed var(--node-choice);
      border-radius: 8px;
    }

    .flow-branch-option {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.75rem;
      color: var(--text-secondary);
    }

    .flow-branch-option::before {
      content: '‚óã';
      color: var(--node-choice);
    }

    /* Free mode box */
    .flow-free-mode {
      padding: 1.5rem;
      background: linear-gradient(135deg, rgba(14, 165, 233, 0.05), rgba(168, 85, 247, 0.05));
      border: 2px dashed var(--ai-cyan);
      border-radius: 12px;
      text-align: center;
      margin: 1rem 0;
    }

    .flow-free-mode h4 {
      margin: 0 0 0.5rem 0;
      color: var(--ai-cyan);
      font-size: 0.9rem;
    }

    .flow-free-mode .chat-line {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.8rem;
      padding: 0.25rem 0;
    }

    .flow-free-mode .chat-line.player { color: var(--ai-green); }
    .flow-free-mode .chat-line.npc { color: var(--ai-purple); }
    .flow-free-mode .chat-line.detect {
      color: var(--ai-orange);
      font-style: italic;
      margin-top: 0.5rem;
      padding-top: 0.5rem;
      border-top: 1px dashed var(--border-color);
    }

    /* Legend */
    .legend {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      padding: 1rem;
      background: var(--bg-tertiary);
      border-radius: 8px;
      margin: 2rem 0;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.8rem;
    }

    .legend-color {
      width: 16px;
      height: 16px;
      border-radius: 4px;
    }

    .legend-color.start { background: var(--node-start); }
    .legend-color.end { background: var(--node-end); }
    .legend-color.ai { background: var(--node-ai); }
    .legend-color.static { background: var(--node-static); }
    .legend-color.choice { background: var(--node-choice); }
    .legend-color.condition { background: var(--node-condition); }
    .legend-color.event { background: var(--node-event); }
    .legend-color.variable { background: var(--node-variable); }
    .legend-color.jump { background: var(--node-jump); }
    .legend-color.free { background: linear-gradient(135deg, var(--node-free), var(--ai-purple)); }
    .legend-color.return { background: linear-gradient(135deg, var(--node-return), var(--node-jump)); }

    /* Modes section */
    .modes-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 1.5rem;
      margin: 2rem 0;
    }

    @media (max-width: 900px) {
      .modes-grid {
        grid-template-columns: 1fr;
      }
    }

    .mode-card {
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      padding: 1.5rem;
      text-align: center;
    }

    .mode-card h4 {
      font-family: var(--font-mono);
      margin: 0 0 0.5rem 0;
    }

    .mode-card.free h4 { color: var(--node-free); }
    .mode-card.scripted h4 { color: var(--node-event); }
    .mode-card.hybrid h4 { color: var(--ai-cyan); }

    .mode-card p {
      font-size: 0.85rem;
      color: var(--text-secondary);
      margin: 0;
    }

    .mode-card .use-case {
      margin-top: 1rem;
      padding-top: 1rem;
      border-top: 1px solid var(--border-color);
      font-size: 0.8rem;
      color: var(--text-muted);
      font-style: italic;
    }
  </style>
</head>
<body>
  <canvas id="neural-bg"></canvas>

  <div class="wiki-container">
    <nav class="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-logo-icon"><img src="../icon.svg" alt="OhMyDialogSystem"></div>
        <div class="sidebar-logo">OhMyDialogSystem</div>
        <div class="sidebar-subtitle">AI-Powered Dialogues</div>
      </div>

      <div class="nav-section">
        <div class="nav-section-title">General</div>
        <ul class="nav-links">
          <li><a href="../index.html"><span class="icon">üè†</span> Home</a></li>
        </ul>
      </div>

      <div class="nav-section">
        <div class="nav-section-title">Getting Started</div>
        <ul class="nav-links">
          <li><a href="../Guides/quickstart.html"><span class="icon">üöÄ</span> Quick Start</a></li>
          <li><a href="../Guides/installation.html"><span class="icon">üì¶</span> Installation</a></li>
          <li><a href="../Guides/first-npc.html"><span class="icon">üéÆ</span> Your First NPC</a></li>
        </ul>
      </div>

      <div class="nav-section">
        <div class="nav-section-title">API Reference</div>
        <ul class="nav-links">
          <li><a href="../API/index.html"><span class="icon">üìö</span> Overview</a></li>
          <li><a href="../API/llama-interface.html"><span class="icon">ü¶ô</span> LlamaInterface</a></li>
          <li><a href="../API/dialogue-manager.html"><span class="icon">üí¨</span> DialogueManager</a></li>
          <li><a href="../API/memory-manager.html"><span class="icon">üß†</span> MemoryManager</a></li>
          <li><a href="../API/tts-manager.html"><span class="icon">üîä</span> TTSManager</a></li>
          <li><a href="../API/resources.html"><span class="icon">üìÑ</span> Resources</a></li>
        </ul>
      </div>

      <div class="nav-section">
        <div class="nav-section-title">Technical</div>
        <ul class="nav-links">
          <li><a href="index.html"><span class="icon">‚öôÔ∏è</span> Overview</a></li>
          <li><a href="architecture.html"><span class="icon">üèóÔ∏è</span> Architecture</a></li>
          <li><a href="dialogue-nodes.html" class="active"><span class="icon">üî∑</span> Dialogue Nodes</a></li>
          <li><a href="gdextension.html"><span class="icon">üîß</span> GDExtension Build</a></li>
          <li><a href="memory-system.html"><span class="icon">üíæ</span> Memory System</a></li>
          <li><a href="localization.html"><span class="icon">üåê</span> Localization</a></li>
        </ul>
      </div>

      <div class="nav-section">
        <div class="nav-section-title">Guides</div>
        <ul class="nav-links">
          <li><a href="../Guides/index.html"><span class="icon">üìñ</span> Overview</a></li>
          <li><a href="../Guides/visual-editor.html"><span class="icon">üé®</span> Visual Editor</a></li>
          <li><a href="../Guides/character-identity.html"><span class="icon">üë§</span> Character Identity</a></li>
          <li><a href="../Guides/tts-setup.html"><span class="icon">üé§</span> TTS Setup</a></li>
          <li><a href="../Guides/csharp-bindings.html"><span class="icon">üî∑</span> C# Bindings</a></li>
        </ul>
      </div>

      <div class="nav-section">
        <div class="nav-section-title">Examples</div>
        <ul class="nav-links">
          <li><a href="../Guides/example-basic-npc.html"><span class="icon">ü§ñ</span> Basic NPC</a></li>
          <li><a href="../Guides/example-branching.html"><span class="icon">üå≥</span> Branching Dialogue</a></li>
          <li><a href="../Guides/example-merchant.html"><span class="icon">üõí</span> Dynamic Merchant</a></li>
        </ul>
      </div>

      <div class="nav-section">
        <div class="nav-section-title">External Links</div>
        <ul class="nav-links">
          <li><a href="https://github.com/lobinuxsoft/OhMyDialogSystem" target="_blank"><span class="icon">üîó</span> GitHub Repository</a></li>
          <li><a href="https://github.com/users/lobinuxsoft/projects/5" target="_blank"><span class="icon">üìã</span> Project Board</a></li>
          <li><a href="https://github.com/lobinuxsoft/OhMyDialogSystem/issues" target="_blank"><span class="icon">üêõ</span> Issues</a></li>
        </ul>
      </div>
    </nav>

    <main class="main-content">
      <div class="breadcrumbs">
        <a href="../index.html">Wiki</a> <span>/</span> <a href="index.html">Technical</a> <span>/</span> <span>Dialogue Nodes</span>
      </div>

      <h1>Dialogue Nodes</h1>

      <p>OhMyDialogSystem utiliza un sistema de nodos visuales para construir grafos de dialogo. A diferencia de otras herramientas, nuestro sistema es <strong>hibrido</strong>: combina estructura de grafos con generacion dinamica por IA.</p>

      <div class="callout-info">
        <p><strong>Diferenciador clave:</strong> La IA genera el CONTENIDO, el grafo controla la ESTRUCTURA.</p>
      </div>

      <hr>

      <h2>Modos de Operacion</h2>

      <p>El DialogueManager puede operar en tres modos:</p>

      <div class="modes-grid">
        <div class="mode-card free">
          <h4>MODE_FREE</h4>
          <p>Conversacion 100% libre. La IA genera respuestas segun el CharacterIdentity sin restricciones de grafo.</p>
          <div class="use-case">Ideal para: Charla casual, exploracion</div>
        </div>
        <div class="mode-card scripted">
          <h4>MODE_SCRIPTED</h4>
          <p>Solo ejecuta nodos del grafo. Sin generacion de IA, todo el contenido esta pre-definido.</p>
          <div class="use-case">Ideal para: Cutscenes, tutoriales</div>
        </div>
        <div class="mode-card hybrid">
          <h4>MODE_HYBRID</h4>
          <p>Lo mejor de ambos mundos. El grafo controla la estructura, la IA genera el contenido.</p>
          <div class="use-case">Ideal para: Misiones, dialogos complejos</div>
        </div>
      </div>

      <hr>

      <h2>Catalogo de Nodos</h2>

      <div class="legend">
        <div class="legend-item"><div class="legend-color start"></div> Start</div>
        <div class="legend-item"><div class="legend-color end"></div> End</div>
        <div class="legend-item"><div class="legend-color ai"></div> AI Response</div>
        <div class="legend-item"><div class="legend-color static"></div> Static Response</div>
        <div class="legend-item"><div class="legend-color choice"></div> Player Choice</div>
        <div class="legend-item"><div class="legend-color condition"></div> Condition</div>
        <div class="legend-item"><div class="legend-color event"></div> Event</div>
        <div class="legend-item"><div class="legend-color variable"></div> Set Variable</div>
        <div class="legend-item"><div class="legend-color jump"></div> Jump</div>
        <div class="legend-item"><div class="legend-color free"></div> Jump to Free</div>
        <div class="legend-item"><div class="legend-color return"></div> Return to Graph</div>
      </div>

      <div class="node-catalog">
        <!-- StartNode -->
        <div class="node-card">
          <div class="node-header start">
            <div class="node-icon start">‚ñ∂</div>
            <div>
              <div class="node-title">StartNode</div>
              <div class="node-subtitle">Punto de entrada</div>
            </div>
          </div>
          <div class="node-body">
            <p class="node-description">Marca el inicio del grafo de dialogo. Cada grafo debe tener exactamente un StartNode.</p>
            <div class="node-slots">
              <span class="slot"><span class="slot-dot output"></span> OUT</span>
            </div>
            <dl class="node-props">
              <dt>trigger</dt>
              <dd>Evento que activa este dialogo (ej: "talk_to_herrero")</dd>
            </dl>
          </div>
        </div>

        <!-- EndNode -->
        <div class="node-card">
          <div class="node-header end">
            <div class="node-icon end">‚ñ†</div>
            <div>
              <div class="node-title">EndNode</div>
              <div class="node-subtitle">Termina dialogo</div>
            </div>
          </div>
          <div class="node-body">
            <p class="node-description">Finaliza la ejecucion del grafo. Puede indicar el resultado del dialogo.</p>
            <div class="node-slots">
              <span class="slot"><span class="slot-dot input"></span> IN</span>
            </div>
            <dl class="node-props">
              <dt>end_type</dt>
              <dd>"normal" | "success" | "fail"</dd>
            </dl>
          </div>
        </div>

        <!-- AIResponseNode -->
        <div class="node-card">
          <div class="node-header ai">
            <div class="node-icon ai">üß†</div>
            <div>
              <div class="node-title">AIResponseNode</div>
              <div class="node-subtitle">IA genera respuesta</div>
            </div>
          </div>
          <div class="node-body">
            <p class="node-description">La IA genera texto dinamicamente usando LlamaInterface y el CharacterIdentity del NPC.</p>
            <div class="node-slots">
              <span class="slot"><span class="slot-dot input"></span> IN</span>
              <span class="slot"><span class="slot-dot output"></span> OUT</span>
            </div>
            <dl class="node-props">
              <dt>character</dt>
              <dd>CharacterIdentity (opcional, usa default del grafo)</dd>
              <dt>prompt_template</dt>
              <dd>Instruccion para la IA (ej: "Saluda al jugador")</dd>
              <dt>emotion_hint</dt>
              <dd>Emocion sugerida: "happy", "angry", "sad"...</dd>
              <dt>temperature</dt>
              <dd>Control de creatividad (0.0 - 1.0)</dd>
            </dl>
          </div>
        </div>

        <!-- StaticResponseNode -->
        <div class="node-card">
          <div class="node-header static">
            <div class="node-icon static">üí¨</div>
            <div>
              <div class="node-title">StaticResponseNode</div>
              <div class="node-subtitle">Texto pre-escrito</div>
            </div>
          </div>
          <div class="node-body">
            <p class="node-description">Muestra texto fijo, sin generacion de IA. Util para lineas importantes o cutscenes.</p>
            <div class="node-slots">
              <span class="slot"><span class="slot-dot input"></span> IN</span>
              <span class="slot"><span class="slot-dot output"></span> OUT</span>
            </div>
            <dl class="node-props">
              <dt>speaker</dt>
              <dd>Nombre del hablante</dd>
              <dt>text</dt>
              <dd>Texto a mostrar</dd>
              <dt>text_variants</dt>
              <dd>Variantes aleatorias (opcional)</dd>
            </dl>
          </div>
        </div>

        <!-- PlayerChoiceNode -->
        <div class="node-card">
          <div class="node-header choice">
            <div class="node-icon choice">‚ò∞</div>
            <div>
              <div class="node-title">PlayerChoiceNode</div>
              <div class="node-subtitle">Opciones del jugador</div>
            </div>
          </div>
          <div class="node-body">
            <p class="node-description">Presenta opciones al jugador. Cada opcion puede tener condiciones y lleva a diferentes caminos.</p>
            <div class="node-slots">
              <span class="slot"><span class="slot-dot input"></span> IN</span>
              <span class="slot"><span class="slot-dot output-multi"></span> OUT x N</span>
            </div>
            <dl class="node-props">
              <dt>choices</dt>
              <dd>Array de opciones con texto y condiciones</dd>
              <dt>generate_with_ai</dt>
              <dd>Si true, la IA genera las opciones</dd>
              <dt>choice_count</dt>
              <dd>Cantidad de opciones a generar (si usa IA)</dd>
            </dl>
          </div>
        </div>

        <!-- ConditionNode -->
        <div class="node-card">
          <div class="node-header condition">
            <div class="node-icon condition">‚óá</div>
            <div>
              <div class="node-title">ConditionNode</div>
              <div class="node-subtitle">Bifurcacion logica</div>
            </div>
          </div>
          <div class="node-body">
            <p class="node-description">Evalua una condicion y bifurca el flujo. Soporta expresiones GDScript.</p>
            <div class="node-slots">
              <span class="slot"><span class="slot-dot input"></span> IN</span>
              <span class="slot" style="color: var(--ai-green)">TRUE ‚Üí</span>
              <span class="slot" style="color: var(--error)">FALSE ‚Üí</span>
            </div>
            <dl class="node-props">
              <dt>expression</dt>
              <dd>Expresion a evaluar (ej: "gold >= 100")</dd>
              <dt>variable_name</dt>
              <dd>Variable a comparar</dd>
              <dt>operator</dt>
              <dd>"==" | "!=" | ">" | "<" | ">=" | "<="</dd>
            </dl>
          </div>
        </div>

        <!-- EventNode -->
        <div class="node-card">
          <div class="node-header event">
            <div class="node-icon event">‚ö°</div>
            <div>
              <div class="node-title">EventNode</div>
              <div class="node-subtitle">Emite senales</div>
            </div>
          </div>
          <div class="node-body">
            <p class="node-description">Dispara un evento/signal que el juego puede escuchar. Ideal para activar misiones, dar items, etc.</p>
            <div class="node-slots">
              <span class="slot"><span class="slot-dot input"></span> IN</span>
              <span class="slot"><span class="slot-dot output"></span> OUT</span>
            </div>
            <dl class="node-props">
              <dt>event_name</dt>
              <dd>Nombre del evento (ej: "quest_started")</dd>
              <dt>event_data</dt>
              <dd>Diccionario con datos adicionales</dd>
              <dt>wait_for_completion</dt>
              <dd>Si espera confirmacion antes de continuar</dd>
            </dl>
          </div>
        </div>

        <!-- SetVariableNode -->
        <div class="node-card">
          <div class="node-header variable">
            <div class="node-icon variable">X=</div>
            <div>
              <div class="node-title">SetVariableNode</div>
              <div class="node-subtitle">Modifica estado</div>
            </div>
          </div>
          <div class="node-body">
            <p class="node-description">Modifica variables del juego. Soporta diferentes scopes y operaciones.</p>
            <div class="node-slots">
              <span class="slot"><span class="slot-dot input"></span> IN</span>
              <span class="slot"><span class="slot-dot output"></span> OUT</span>
            </div>
            <dl class="node-props">
              <dt>variable_name</dt>
              <dd>Nombre de la variable</dd>
              <dt>operation</dt>
              <dd>"set" | "add" | "subtract" | "toggle"</dd>
              <dt>value</dt>
              <dd>Valor a asignar/operar</dd>
              <dt>scope</dt>
              <dd>"local" | "global" | "character"</dd>
            </dl>
          </div>
        </div>

        <!-- JumpNode -->
        <div class="node-card">
          <div class="node-header jump">
            <div class="node-icon jump">‚Ü™</div>
            <div>
              <div class="node-title">JumpNode</div>
              <div class="node-subtitle">Salta a otro grafo</div>
            </div>
          </div>
          <div class="node-body">
            <p class="node-description">Salta a otro DialogueGraph, permitiendo modularizar dialogos complejos.</p>
            <div class="node-slots">
              <span class="slot"><span class="slot-dot input"></span> IN</span>
              <span class="slot"><span class="slot-dot special"></span> JUMP</span>
            </div>
            <dl class="node-props">
              <dt>target_graph</dt>
              <dd>DialogueGraph destino (.tres)</dd>
              <dt>target_node_id</dt>
              <dd>Nodo especifico (opcional, default: start)</dd>
              <dt>pass_context</dt>
              <dd>Mantener variables locales</dd>
            </dl>
          </div>
        </div>

        <!-- JumpToFreeNode - NUEVO -->
        <div class="node-card new-concept">
          <div class="node-header free">
            <div class="node-icon free">‚àû</div>
            <div>
              <div class="node-title">JumpToFreeNode</div>
              <div class="node-subtitle">Entra a modo libre</div>
            </div>
          </div>
          <div class="node-body">
            <p class="node-description"><strong>Concepto unico de OhMyDialogSystem.</strong> Escapa del grafo a conversacion libre con IA, con condiciones configurables para volver.</p>
            <div class="node-slots">
              <span class="slot"><span class="slot-dot input"></span> IN</span>
              <span class="slot"><span class="slot-dot special"></span> ‚Üí FREE MODE</span>
            </div>
            <dl class="node-props">
              <dt>return_conditions</dt>
              <dd>Condiciones que disparan el retorno al grafo</dd>
              <dt>max_exchanges</dt>
              <dd>Limite de intercambios (-1 = ilimitado)</dd>
              <dt>timeout_seconds</dt>
              <dd>Timeout para forzar retorno (0 = sin limite)</dd>
              <dt>on_return_node_id</dt>
              <dd>Nodo al que volver cuando se active el retorno</dd>
            </dl>
          </div>
        </div>

        <!-- ReturnToGraphNode - NUEVO -->
        <div class="node-card new-concept">
          <div class="node-header return">
            <div class="node-icon return">‚Ü©</div>
            <div>
              <div class="node-title">ReturnToGraphNode</div>
              <div class="node-subtitle">Vuelve al grafo</div>
            </div>
          </div>
          <div class="node-body">
            <p class="node-description"><strong>Complemento de JumpToFree.</strong> Define como detectar cuando volver al grafo desde modo libre.</p>
            <div class="node-slots">
              <span class="slot"><span class="slot-dot input"></span> IN</span>
              <span class="slot"><span class="slot-dot output"></span> OUT</span>
            </div>
            <dl class="node-props">
              <dt>trigger_keywords</dt>
              <dd>Palabras que activan retorno (ej: ["acepto", "si"])</dd>
              <dt>trigger_intent</dt>
              <dd>Intencion detectada por IA (ej: "accept_quest")</dd>
              <dt>use_ai_detection</dt>
              <dd>Usar IA para detectar intencion vs solo keywords</dd>
            </dl>
          </div>
        </div>
      </div>

      <hr>

      <h2>Ejemplo: Mision del Herrero</h2>

      <p>Este diagrama muestra un flujo completo usando el sistema hibrido:</p>

      <div class="flow-diagram">
        <div class="flow-title">
          <h3>herrero_quest.tres</h3>
          <p>Mision de encontrar la espada perdida</p>
        </div>

        <div class="flow-container">
          <!-- Row 1: Start -> AI Saludo -> JumpToFree -->
          <div class="flow-row">
            <div class="flow-node start">‚ñ∂ START</div>
            <span class="flow-arrow">‚Üí</span>
            <div class="flow-node ai">üß† AI: Saludo</div>
            <span class="flow-arrow">‚Üí</span>
            <div class="flow-node free">‚àû JumpToFree</div>
          </div>

          <!-- Free mode box -->
          <div class="flow-row centered">
            <div class="flow-free-mode">
              <h4>MODO FREE - Conversacion Abierta</h4>
              <div class="chat-line player">üë§ Jugador: "Hola, buen dia"</div>
              <div class="chat-line npc">üßô NPC: "Bienvenido a mi herreria, viajero"</div>
              <div class="chat-line player">üë§ Jugador: "Tienes algun trabajo para mi?"</div>
              <div class="chat-line detect">‚ö° Detecta keyword: "trabajo" ‚Üí Activa retorno</div>
            </div>
          </div>

          <!-- Return node -->
          <div class="flow-row centered">
            <div class="flow-node return">‚Ü© ReturnToGraph</div>
            <span class="flow-arrow">‚Üí</span>
            <div class="flow-node ai">üß† AI: Ofrecer mision</div>
          </div>

          <!-- Player choice -->
          <div class="flow-row centered">
            <span class="flow-arrow">‚Üì</span>
          </div>

          <div class="flow-row centered">
            <div class="flow-branch">
              <div style="text-align: center; margin-bottom: 0.5rem; color: var(--node-choice); font-weight: bold;">‚ò∞ PlayerChoice</div>
              <div class="flow-branch-option">"Acepto la mision" ‚Üí Ruta A</div>
              <div class="flow-branch-option">"No me interesa" ‚Üí Ruta B</div>
              <div class="flow-branch-option">"Cuanto pagan?" ‚Üí Ruta C</div>
            </div>
          </div>

          <!-- Branch A: Accept -->
          <div class="flow-row">
            <div style="color: var(--text-muted); font-size: 0.8rem; width: 100px;">Ruta A:</div>
            <div class="flow-node event">‚ö° quest_started</div>
            <span class="flow-arrow">‚Üí</span>
            <div class="flow-node variable">X= quest_status="active"</div>
            <span class="flow-arrow">‚Üí</span>
            <div class="flow-node ai">üß† AI: Despedida</div>
            <span class="flow-arrow">‚Üí</span>
            <div class="flow-node end">‚ñ† END (success)</div>
          </div>

          <!-- Branch B: Reject -->
          <div class="flow-row">
            <div style="color: var(--text-muted); font-size: 0.8rem; width: 100px;">Ruta B:</div>
            <div class="flow-node static">üí¨ "Hasta luego"</div>
            <span class="flow-arrow">‚Üí</span>
            <div class="flow-node end">‚ñ† END (normal)</div>
          </div>

          <!-- Branch C: Ask price (loops back) -->
          <div class="flow-row">
            <div style="color: var(--text-muted); font-size: 0.8rem; width: 100px;">Ruta C:</div>
            <div class="flow-node ai">üß† AI: Explicar recompensa</div>
            <span class="flow-arrow">‚Üí</span>
            <span style="color: var(--text-muted); font-size: 0.8rem;">(vuelve a PlayerChoice)</span>
          </div>
        </div>
      </div>

      <hr>

      <h2>Lo Que Nos Diferencia</h2>

      <p>Comparacion con otras herramientas de dialogo para Godot:</p>

      <table>
        <thead>
          <tr>
            <th>Caracteristica</th>
            <th>Dialogic</th>
            <th>Clyde</th>
            <th>OhMyDialogSystem</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Editor visual</td>
            <td>‚úì</td>
            <td>‚úó</td>
            <td>‚úì</td>
          </tr>
          <tr>
            <td>Generacion IA</td>
            <td>‚úó</td>
            <td>‚úó</td>
            <td>‚úì</td>
          </tr>
          <tr>
            <td>Modo libre + grafos</td>
            <td>‚úó</td>
            <td>‚úó</td>
            <td>‚úì</td>
          </tr>
          <tr>
            <td>Transiciones fluidas</td>
            <td>‚úó</td>
            <td>‚úó</td>
            <td>‚úì</td>
          </tr>
          <tr>
            <td>Opciones generadas por IA</td>
            <td>‚úó</td>
            <td>‚úó</td>
            <td>‚úì</td>
          </tr>
        </tbody>
      </table>

      <hr>

      <a href="index.html">‚Üê Volver a Technical</a>

      <footer class="wiki-footer">
        <p>OhMyDialogSystem Wiki | <a href="https://github.com/lobinuxsoft/OhMyDialogSystem" target="_blank">GitHub</a></p>
      </footer>
    </main>
  </div>

  <script src="../ai-bg.js"></script>
</body>
</html>
