<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GDExtension Build - OhMyDialogSystem Wiki</title>
  <link rel="stylesheet" href="../styles.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
</head>
<body>
  <canvas id="neural-bg"></canvas>

  <div class="wiki-container">
    <nav class="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-logo-icon"><img src="../logo-eldritch.png" alt="OhMyDialogSystem"></div>
        <div class="sidebar-logo">OhMyDialogSystem</div>
        <div class="sidebar-subtitle">AI-Powered Dialogues</div>
      </div>

      <div class="nav-section">
        <div class="nav-section-title">General</div>
        <ul class="nav-links">
          <li><a href="../index.html"><span class="icon">üè†</span> Home</a></li>
        </ul>
      </div>

      <div class="nav-section">
        <div class="nav-section-title">Getting Started</div>
        <ul class="nav-links">
          <li><a href="../Guides/quickstart.html"><span class="icon">üöÄ</span> Quick Start</a></li>
          <li><a href="../Guides/installation.html"><span class="icon">üì¶</span> Installation</a></li>
          <li><a href="../Guides/first-npc.html"><span class="icon">üéÆ</span> Your First NPC</a></li>
        </ul>
      </div>

      <div class="nav-section">
        <div class="nav-section-title">API Reference</div>
        <ul class="nav-links">
          <li><a href="../API/index.html"><span class="icon">üìö</span> Overview</a></li>
          <li><a href="../API/llama-interface.html"><span class="icon">ü¶ô</span> LlamaInterface</a></li>
          <li><a href="../API/dialogue-manager.html"><span class="icon">üí¨</span> DialogueManager</a></li>
          <li><a href="../API/memory-manager.html"><span class="icon">üß†</span> MemoryManager</a></li>
          <li><a href="../API/tts-manager.html"><span class="icon">üîä</span> TTSManager</a></li>
          <li><a href="../API/resources.html"><span class="icon">üìÑ</span> Resources</a></li>
        </ul>
      </div>

      <div class="nav-section">
        <div class="nav-section-title">Technical</div>
        <ul class="nav-links">
          <li><a href="index.html"><span class="icon">‚öôÔ∏è</span> Overview</a></li>
          <li><a href="architecture.html"><span class="icon">üèóÔ∏è</span> Architecture</a></li>
          <li><a href="dialogue-nodes.html"><span class="icon">üî∑</span> Dialogue Nodes</a></li>
          <li><a href="gdextension.html" class="active"><span class="icon">üîß</span> GDExtension Build</a></li>
          <li><a href="memory-system.html"><span class="icon">üíæ</span> Memory System</a></li>
          <li><a href="localization.html"><span class="icon">üåê</span> Localization</a></li>
        </ul>
      </div>

      <div class="nav-section">
        <div class="nav-section-title">Guides</div>
        <ul class="nav-links">
          <li><a href="../Guides/index.html"><span class="icon">üìñ</span> Overview</a></li>
          <li><a href="../Guides/visual-editor.html"><span class="icon">üé®</span> Visual Editor</a></li>
          <li><a href="../Guides/character-identity.html"><span class="icon">üë§</span> Character Identity</a></li>
          <li><a href="../Guides/tts-setup.html"><span class="icon">üé§</span> TTS Setup</a></li>
          <li><a href="../Guides/csharp-bindings.html"><span class="icon">üî∑</span> C# Bindings</a></li>
        </ul>
      </div>

      <div class="nav-section">
        <div class="nav-section-title">Examples</div>
        <ul class="nav-links">
          <li><a href="../Guides/example-basic-npc.html"><span class="icon">ü§ñ</span> Basic NPC</a></li>
          <li><a href="../Guides/example-branching.html"><span class="icon">üå≥</span> Branching Dialogue</a></li>
          <li><a href="../Guides/example-merchant.html"><span class="icon">üõí</span> Dynamic Merchant</a></li>
        </ul>
      </div>

      <div class="nav-section">
        <div class="nav-section-title">External Links</div>
        <ul class="nav-links">
          <li><a href="https://github.com/lobinuxsoft/OhMyDialogSystem" target="_blank"><span class="icon">üîó</span> GitHub Repository</a></li>
          <li><a href="https://github.com/users/lobinuxsoft/projects/5" target="_blank"><span class="icon">üìã</span> Project Board</a></li>
          <li><a href="https://github.com/lobinuxsoft/OhMyDialogSystem/issues" target="_blank"><span class="icon">üêõ</span> Issues</a></li>
        </ul>
      </div>
    </nav>

    <main class="main-content">
      <div class="breadcrumbs">
        <a href="../index.html">Wiki</a> <span>/</span> <a href="index.html">Technical</a> <span>/</span> <span>GDExtension Build</span>
      </div>

      <h1>GDExtension Build Guide</h1>

      <p>Guia completa para compilar la GDExtension de OhMyDialogSystem con integracion de llama.cpp.</p>

      <hr>

      <h2>Prerequisitos</h2>

      <h3>Todas las Plataformas</h3>

      <ul>
        <li><strong>Python 3.10+</strong> con pip</li>
        <li><strong>SCons 4.x+</strong>: <code>pip install scons</code></li>
        <li><strong>CMake 3.20+</strong></li>
        <li><strong>Ninja</strong> (recomendado para builds mas rapidos)</li>
        <li><strong>Git</strong> (para submodulos)</li>
      </ul>

      <h3>Linux</h3>

      <table>
        <thead>
          <tr>
            <th>Paquete</th>
            <th>Fedora/Bazzite</th>
            <th>Ubuntu/Debian</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Compilador C++</td>
            <td><code>gcc-c++</code></td>
            <td><code>build-essential</code></td>
          </tr>
          <tr>
            <td>Headers de desarrollo</td>
            <td><code>libstdc++-devel</code></td>
            <td><code>libstdc++-dev</code></td>
          </tr>
        </tbody>
      </table>

      <div class="callout-warning">
        <p><strong>Bazzite/Fedora Silverblue (rpm-ostree):</strong> Si hay conflictos de version con gcc, descargar la version exacta desde <a href="https://kojipkgs.fedoraproject.org/packages/" target="_blank">Koji</a>.</p>
      </div>

      <h3>Windows</h3>

      <ul>
        <li><strong>Visual Studio 2022</strong> con workload de C++, o</li>
        <li><strong>MinGW-w64</strong> (GCC 12+)</li>
        <li><strong>CMake</strong> (desde cmake.org o Visual Studio)</li>
      </ul>

      <h3>macOS</h3>

      <ul>
        <li><strong>Xcode Command Line Tools</strong>: <code>xcode-select --install</code></li>
        <li><strong>CMake</strong>: <code>brew install cmake ninja</code></li>
      </ul>

      <hr>

      <h2>Compilacion</h2>

      <h3>1. Clonar con submodulos</h3>

      <pre data-lang="BASH"><code>git clone --recursive https://github.com/lobinuxsoft/OhMyDialogSystem.git
cd OhMyDialogSystem</code></pre>

      <p>Si ya esta clonado:</p>

      <pre data-lang="BASH"><code>git submodule update --init --recursive</code></pre>

      <h3>2. Compilar llama.cpp (primera vez)</h3>

      <pre data-lang="BASH"><code># Linux/macOS
./gdextension/scripts/build_llama.sh --cpu

# Windows
gdextension\scripts\build_llama.bat --cpu</code></pre>

      <h3>3. Compilar GDExtension</h3>

      <h4>Usando los scripts de build (recomendado)</h4>

      <p>Los scripts <code>build.bat</code> (Windows) y <code>build.sh</code> (Linux/macOS) simplifican el proceso:</p>

      <pre data-lang="BASH"><code>cd gdextension

# Windows
build.bat editor          # Para desarrollo en el editor
build.bat debug           # Para exportar en modo debug
build.bat release         # Para exportar en modo release

# Linux/macOS
./build.sh editor
./build.sh debug
./build.sh release</code></pre>

      <div class="callout-warning">
        <p><strong>Importante:</strong> Para abrir el proyecto en el editor de Godot, <strong>debes compilar con <code>editor</code></strong>. El target <code>template_debug</code> solo sirve para exportar el juego, no para desarrollo.</p>
      </div>

      <h4>Entendiendo los targets</h4>

      <table>
        <thead>
          <tr>
            <th>Target</th>
            <th>Uso</th>
            <th>Cuando compilar</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>editor</code></td>
            <td>Desarrollo en el editor de Godot</td>
            <td><strong>Siempre</strong> - necesario para abrir el proyecto</td>
          </tr>
          <tr>
            <td><code>template_debug</code></td>
            <td>Exportar juego con debug habilitado</td>
            <td>Cuando quieras probar exports con debugging</td>
          </tr>
          <tr>
            <td><code>template_release</code></td>
            <td>Exportar juego optimizado para produccion</td>
            <td>Para distribuir el juego final</td>
          </tr>
        </tbody>
      </table>

      <h4>Usando SCons directamente</h4>

      <p>Si prefieres control manual:</p>

      <pre data-lang="BASH"><code>cd gdextension

# Linux
scons platform=linux target=editor

# Windows
scons platform=windows target=editor

# macOS
scons platform=macos target=editor</code></pre>

      <hr>

      <h2>Opciones de Build</h2>

      <h3>Opciones de llama.cpp</h3>

      <table>
        <thead>
          <tr>
            <th>Opcion</th>
            <th>Valores</th>
            <th>Default</th>
            <th>Descripcion</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>llama_backend</code></td>
            <td>cpu, cuda, vulkan, metal, sycl</td>
            <td>cpu</td>
            <td>Backend de computo</td>
          </tr>
          <tr>
            <td><code>llama_native</code></td>
            <td>yes, no</td>
            <td>yes</td>
            <td>Optimizaciones nativas de CPU</td>
          </tr>
          <tr>
            <td><code>llama_avx2</code></td>
            <td>yes, no</td>
            <td>yes</td>
            <td>Instrucciones AVX2 (x86_64)</td>
          </tr>
          <tr>
            <td><code>llama_rebuild</code></td>
            <td>yes, no</td>
            <td>no</td>
            <td>Forzar rebuild de llama.cpp</td>
          </tr>
        </tbody>
      </table>

      <p>Ejemplo:</p>

      <pre data-lang="BASH"><code>scons platform=linux target=template_release llama_backend=cpu llama_native=yes</code></pre>

      <h3>Opciones estandar de godot-cpp</h3>

      <table>
        <thead>
          <tr>
            <th>Opcion</th>
            <th>Valores</th>
            <th>Descripcion</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>platform</code></td>
            <td>linux, windows, macos, ios, android</td>
            <td>Plataforma objetivo</td>
          </tr>
          <tr>
            <td><code>target</code></td>
            <td>editor, template_debug, template_release</td>
            <td>Tipo de build</td>
          </tr>
          <tr>
            <td><code>arch</code></td>
            <td>x86_64, arm64</td>
            <td>Arquitectura objetivo</td>
          </tr>
        </tbody>
      </table>

      <hr>

      <h2>Aceleracion GPU (Opcional)</h2>

      <h3>Vulkan</h3>

      <p>Requiere paquetes adicionales:</p>

      <pre data-lang="BASH"><code># Linux (Fedora)
sudo dnf install vulkan-devel shaderc

# Luego recompilar con:
./gdextension/scripts/build_llama.sh --vulkan --clean
scons platform=linux llama_backend=vulkan</code></pre>

      <div class="callout-info">
        <p>Ver <a href="https://github.com/lobinuxsoft/OhMyDialogSystem/issues/53" target="_blank">Issue #53</a> para el estado del soporte Vulkan.</p>
      </div>

      <h3>CUDA</h3>

      <p>Requiere NVIDIA CUDA Toolkit 11.7+.</p>

      <pre data-lang="BASH"><code>./gdextension/scripts/build_llama.sh --cuda
scons platform=linux llama_backend=cuda</code></pre>

      <hr>

      <h2>Troubleshooting</h2>

      <h3>"cannot find -lstdc++"</h3>

      <p>El build requiere libstdc++ estatico por defecto. Si no esta disponible, el SConstruct automaticamente usa linkeo dinamico. Para distribucion, considerar:</p>

      <pre data-lang="BASH"><code># Fedora
sudo dnf install libstdc++-static</code></pre>

      <h3>"llama.cpp not found"</h3>

      <p>Asegurar que los submodulos estan inicializados:</p>

      <pre data-lang="BASH"><code>git submodule update --init --recursive</code></pre>

      <h3>Errores de CMake durante build de llama.cpp</h3>

      <p>Los scripts de build usan estos flags para evitar dependencias opcionales:</p>

      <ul>
        <li><code>-DLLAMA_CURL=OFF</code> - Desactiva descarga de modelos (no necesario)</li>
        <li><code>-DLLAMA_BUILD_TOOLS=OFF</code> - Salta herramientas CLI (no necesario)</li>
      </ul>

      <hr>

      <h2>Output</h2>

      <p>Las librerias compiladas se colocan en <code>addons/ohmydialog/gdextension/</code>:</p>

      <style>
        .binary-tree {
          background: linear-gradient(135deg, rgba(16, 185, 129, 0.05), rgba(59, 130, 246, 0.05));
          border: 1px solid rgba(16, 185, 129, 0.3);
          border-radius: 12px;
          padding: 1.5rem;
          font-family: 'JetBrains Mono', monospace;
          margin: 1.5rem 0;
        }
        .binary-tree .tree-header {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          padding-bottom: 1rem;
          border-bottom: 1px solid rgba(255,255,255,0.1);
          margin-bottom: 1rem;
        }
        .binary-tree .tree-header .icon { font-size: 1.5rem; }
        .binary-tree .tree-header .title {
          font-weight: 600;
          color: #10b981;
          font-size: 1.1rem;
        }
        .binary-tree .platform-group {
          margin-bottom: 1rem;
        }
        .binary-tree .platform-group:last-child { margin-bottom: 0; }
        .binary-tree .platform-header {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          margin-bottom: 0.5rem;
          padding: 0.25rem 0;
        }
        .binary-tree .platform-header .icon { font-size: 1.2rem; }
        .binary-tree .platform-header .name {
          font-weight: 500;
          color: var(--text-primary);
        }
        .binary-tree .binary-list {
          list-style: none;
          padding: 0;
          margin: 0 0 0 1.5rem;
          border-left: 2px solid rgba(255,255,255,0.1);
        }
        .binary-tree .binary-item {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          padding: 0.35rem 0 0.35rem 1rem;
          position: relative;
          transition: background 0.2s ease;
        }
        .binary-tree .binary-item::before {
          content: '';
          position: absolute;
          left: 0;
          top: 50%;
          width: 0.75rem;
          height: 2px;
          background: rgba(255,255,255,0.1);
        }
        .binary-tree .binary-item:hover {
          background: rgba(255,255,255,0.05);
          border-radius: 4px;
        }
        .binary-tree .binary-item .icon { font-size: 1rem; opacity: 0.8; }
        .binary-tree .binary-item .name {
          color: var(--text-secondary);
          font-size: 0.85rem;
        }
        .binary-tree .binary-item .tag {
          font-size: 0.7rem;
          padding: 0.15rem 0.4rem;
          border-radius: 4px;
          font-weight: 500;
        }
        .binary-tree .tag-editor {
          background: rgba(59, 130, 246, 0.2);
          color: #60a5fa;
        }
        .binary-tree .tag-debug {
          background: rgba(234, 179, 8, 0.2);
          color: #facc15;
        }
        .binary-tree .tag-release {
          background: rgba(16, 185, 129, 0.2);
          color: #34d399;
        }
      </style>

      <div class="binary-tree">
        <div class="tree-header">
          <span class="icon">üì¶</span>
          <span class="title">addons/ohmydialog/gdextension/</span>
        </div>

        <!-- Windows -->
        <div class="platform-group">
          <div class="platform-header">
            <span class="icon">ü™ü</span>
            <span class="name">Windows</span>
          </div>
          <ul class="binary-list">
            <li class="binary-item">
              <span class="icon">‚öôÔ∏è</span>
              <span class="name">libohmydialog.windows.editor.x86_64.dll</span>
              <span class="tag tag-editor">editor</span>
            </li>
            <li class="binary-item">
              <span class="icon">‚öôÔ∏è</span>
              <span class="name">libohmydialog.windows.template_debug.x86_64.dll</span>
              <span class="tag tag-debug">debug</span>
            </li>
            <li class="binary-item">
              <span class="icon">‚öôÔ∏è</span>
              <span class="name">libohmydialog.windows.template_release.x86_64.dll</span>
              <span class="tag tag-release">release</span>
            </li>
          </ul>
        </div>

        <!-- Linux -->
        <div class="platform-group">
          <div class="platform-header">
            <span class="icon">üêß</span>
            <span class="name">Linux</span>
          </div>
          <ul class="binary-list">
            <li class="binary-item">
              <span class="icon">‚öôÔ∏è</span>
              <span class="name">libohmydialog.linux.editor.x86_64.so</span>
              <span class="tag tag-editor">editor</span>
            </li>
            <li class="binary-item">
              <span class="icon">‚öôÔ∏è</span>
              <span class="name">libohmydialog.linux.template_debug.x86_64.so</span>
              <span class="tag tag-debug">debug</span>
            </li>
            <li class="binary-item">
              <span class="icon">‚öôÔ∏è</span>
              <span class="name">libohmydialog.linux.template_release.x86_64.so</span>
              <span class="tag tag-release">release</span>
            </li>
          </ul>
        </div>

        <!-- macOS -->
        <div class="platform-group">
          <div class="platform-header">
            <span class="icon">üçé</span>
            <span class="name">macOS</span>
          </div>
          <ul class="binary-list">
            <li class="binary-item">
              <span class="icon">üìÅ</span>
              <span class="name">libohmydialog.macos.editor.framework/</span>
              <span class="tag tag-editor">editor</span>
            </li>
            <li class="binary-item">
              <span class="icon">üìÅ</span>
              <span class="name">libohmydialog.macos.template_debug.framework/</span>
              <span class="tag tag-debug">debug</span>
            </li>
            <li class="binary-item">
              <span class="icon">üìÅ</span>
              <span class="name">libohmydialog.macos.template_release.framework/</span>
              <span class="tag tag-release">release</span>
            </li>
          </ul>
        </div>
      </div>

      <div class="callout-info">
        <p>Solo se generan los binarios de la plataforma y target que compiles. Para un setup completo de desarrollo, compila al menos el target <code>editor</code> de tu plataforma.</p>
      </div>

      <hr>

      <a href="index.html">‚Üê Volver a Technical</a>

      <footer class="wiki-footer">
        <p>OhMyDialogSystem Wiki | <a href="https://github.com/lobinuxsoft/OhMyDialogSystem" target="_blank">GitHub</a></p>
      </footer>
    </main>
  </div>

  <script src="../ai-bg.js"></script>
</body>
</html>
